# 데이터 과학을 위한 R 알고리즘




## 1. 음이항 분포(Negative Binomial Distribution) [^negative-binomial] {#negative-binomial-distribution}

[^negative-binomial]: [위키백과 - Negative binomial distribution](https://en.wikipedia.org/wiki/Negative_binomial_distribution)

음이항 분포는 기하분포를 확장한 분포로 성공이 최초 목격되는 것은 확장하여 $r$ 번째 성공할 확률을 모형화한 것이다.

- 시행횟수: $n$
- 성공횟수: $r$
- 성공확률: $p$

즉, $n$ 번재 성공을 가정하면 그 이전 모든 조합수를 바탕으로 성공과 실패 확률을 각각 곱하주면 구할 수 있다.

$$ \text{음이항분포}(n;r,p) = \binom{n-1}{r-1} p^r (1-p)^{n-r}$$

음이항 분포를 표현하는 다양한 방법

- 총시도 횟수와 실패: $\text{음이항분포}(n;r,p) = \binom{n-1}{r-1} p^r (1-p)^{n-r}$
- 실패($k$)과 성공($n$): $\text{음이항분포}(k;n,p) = \binom{k+n-1}{n-1} p^n (1-p)^{k}$
- 성공($k$)과 실패($r$): $\text{음이항분포}(k;r,p) = \binom{k+r-1}{r-1} p^k (1-p)^{r}$


## 2. 사례 {#nb-examples}

### 2.1. 자유투 {#free-throw}

예를 들어, 농구 자유투를 5개 던져 3개를 성공할 확률은 어떻게 될까? 매번 자유투를 던질 때 자유투 성공률은 0.7로 가정한다.


~~~{.r}
# 1. 농구 자유투 ----------------------------------------
nb_pdf <- function(n, r, p) {
    choose(n-1, r-1) * (p)^r * (1-p)^(n-r)
}

nb_pdf(5, 3, 0.7)
~~~



~~~{.output}
[1] 0.18522

~~~



~~~{.r}
dnbinom(5-3, 3, 0.7)
~~~



~~~{.output}
[1] 0.18522

~~~

### 2.2. 사탕 판매(Selling Candy) {#selling-candy}

정훈학생이 미국에서 이민가서 미국전통에 따라 캔디를 팔아야 돼는 상황이 되었다.
정훈학생이 거주하는 지역에는 30가구가 있고, "캔디 사세요"라고 가가호호 방문하여 사탕을 판매할 때 한 가구에서 
사탕을 구매할 확률은 0.4 로 40%나 된다. 10집을 방문하여 학교에서 숙제로 받은 사탕 5개를 모두 판매하여 성공할 확률은 얼마나 될까?


~~~{.r}
# 2. 사탕 판매 ----------------------------------------
nb_pdf(10, 5, 0.4)
~~~



~~~{.output}
[1] 0.1003291

~~~



~~~{.r}
dnbinom(10-5, 5, 0.4)
~~~



~~~{.output}
[1] 0.1003291

~~~

이번에는 8번째 집을 방문하기 전 숙제로 받은 모든 캔디를 모두 판매할 확률은 얼마나 될까?


~~~{.r}
# 8번째 집을 방문하기 전 캔디 5개를 모두 판매할 확률
nb_pdf(5, 5, 0.4) + nb_pdf(6, 5, 0.4) + nb_pdf(7, 5, 0.4) + nb_pdf(8, 5, 0.4)
~~~



~~~{.output}
[1] 0.1736704

~~~



~~~{.r}
sum(dnbinom(5:8-5, 5, 0.4))
~~~



~~~{.output}
[1] 0.1736704

~~~





