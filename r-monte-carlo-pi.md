# 데이터 과학을 위한 R 알고리즘



## 1. 기계를 활용한 원주율 계산 [^r-monte-carlo] {#pi}

[^r-monte-carlo]: [Estimating Pi with R via MCS-Dart: A very simple example of numerical integration, illustrated and computed in R.](http://giventhedata.blogspot.kr/2012/09/estimating-pi-with-r-via-mcs-dart-very.html)

컴퓨터를 활용하여 원주율을 계산하기 위해서 사각형 면적과 원면적 비율을 활용하여 원주율($\pi$)를 도출한다.

즉, 가로세로가 2인 사각형내부에 반지름이 1인 원을 내접하여 표현하면 다음과 같이 그려본다.


~~~{.r}
# library(purrr)
# library(shape)
# library(tidyverse)
# library(hrbrthemes)
# library(extrafont)
# loadfonts()

## 1.1. 반지름 1인 원 ------------------------------
r <- 1
par(pty="s")
emptyplot(c(0, 0),frame.plot=r)
plotcircle(r=r, mid=c(0,0), lwd=1, lcol="blue")
lines(x=c(0,1),y=c(0,0), lty=1, col="red")
lines(x=c(-1,1),y=c(0,0), lty=2)
lines(y=c(-1,1),x=c(0,0), lty=2)
axis(1)
axis(2)
text(x=0.5,y=0.2, labels=expression("r=1"), col="red")
~~~

<img src="fig/pi-overview-1.png" style="display: block; margin: auto;" />

피타고라스 정리를 이용하여 원 내부에 위치하면 원 내부면적에 위치하는지를 파악한다.

- $\text{원면적} = \pi \times r^2$
- $\text{정사각형면적} = {(2 \times r)}^2 = 4 \times r^2$

상기 두 면적의 비를 통하여 원주율($\pi$)를 다음과 같이 수식을 정리하여 도출한다.

$$\frac{\text{원 면적}}{\text{정사각형 면적}} = \frac{\pi \times r^2}{4 \times r^2}$$
$\pi$에 관해 수식을 정리하면 다음과 같다.

$$\pi = 4 \times \frac{\text{원 면적}}{\text{정사각형 면적}}$$



~~~{.r}
## 1.2. 피타고라스 정리 ------------------------------
### 원
emptyplot(frame.plot=r)
plotcircle(r=r, mid=c(0,0), lwd=1,lcol="blue")
lines(x=c(0,1),y=c(0,0), lty=1, col="red")
lines(x=c(-1,1),y=c(0,0), lty=2)
lines(y=c(-1,1),x=c(0,0), lty=2)
axis(1)
axis(2)

### 피타고라스 정리
points(x=0.8,y=0.58,col="red", lwd=2)
lines(x=c(0,0.8), y=c(0,0), col="red", lwd=2)
lines(x=c(0.8,0.8), y=c(0,0.58), col="red", lwd=2)
lines(x=c(0,0.8), y=c(0,0.58), col="red", lty=2,lwd=2)
text(x=0.4,y=0.4,"c",col="red")
title(expression(c == sqrt(a^2 + b^2)))
~~~

<img src="fig/pi-Pythagorean-1.png" style="display: block; margin: auto;" />

## 2. 몬테카를로 모의실험  {#r-monte-carlo-sim}

`simulate_pi` 함수를 만들어서 정사각형 길이가 2가 되기 때문에 -1에서 1사이 일양분포(uniform)에서 x, y 좌표 점을 
무작위로 뽑아내서 피타고라스 정리를 활용하여 원 내부에 위치하는지 원 외부에 위치하는지 파악한다.
이를 부울을 R 내부적으로 데이터를 표현하는 특성을 활용하여 더하면 원내부 위치하는 점의 갯수가 되고 이를 
전체 모의실험 횟수로 나누게 되면 원주율을 계산할 수 있다.


~~~{.r}
# 2. 몬테카를로 모의실험 -----------------------

simulate_pi <- function(iter = 1000) {
  
  x_pos <- runif(iter, min=-1, max=1)
  y_pos <- runif(iter, min=-1, max=1)

  xy_pos <- ifelse(x_pos^2 + y_pos^2 <= 1, TRUE, FALSE)
  
  pi_val <- 4*(sum(xy_pos)/iter)
  return(pi_val)
}

simulate_pi(1000000)
~~~



~~~{.output}
[1] 3.140768

~~~



~~~{.r}
# 3. 원주율 값 수렴 시각화  -----------------------
## 3.1. 데이터 준비 -------------------------------
sim_iter_lst <- list()

for(i in 1:10^5) {
  if(i %% 100 == 0) {
    sim_iter_lst[[length(sim_iter_lst)+1]] <- i
  }
}

iter_v <- sim_iter_lst %>% unlist
pi_v <- map(sim_iter_lst, simulate_pi) %>% unlist

pi_df <- data.frame("반복횟수"=iter_v, "원주율"=pi_v)

DT::datatable(pi_df) %>% 
  DT::formatCurrency("원주율", currency ="", interval = 3, mark = ",", digits = 5)
~~~

<!--html_preserve--><div id="htmlwidget-ed66fcf837e403e8334c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed66fcf837e403e8334c">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000"],[100,200,300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,5200,5300,5400,5500,5600,5700,5800,5900,6000,6100,6200,6300,6400,6500,6600,6700,6800,6900,7000,7100,7200,7300,7400,7500,7600,7700,7800,7900,8000,8100,8200,8300,8400,8500,8600,8700,8800,8900,9000,9100,9200,9300,9400,9500,9600,9700,9800,9900,10000,10100,10200,10300,10400,10500,10600,10700,10800,10900,11000,11100,11200,11300,11400,11500,11600,11700,11800,11900,12000,12100,12200,12300,12400,12500,12600,12700,12800,12900,13000,13100,13200,13300,13400,13500,13600,13700,13800,13900,14000,14100,14200,14300,14400,14500,14600,14700,14800,14900,15000,15100,15200,15300,15400,15500,15600,15700,15800,15900,16000,16100,16200,16300,16400,16500,16600,16700,16800,16900,17000,17100,17200,17300,17400,17500,17600,17700,17800,17900,18000,18100,18200,18300,18400,18500,18600,18700,18800,18900,19000,19100,19200,19300,19400,19500,19600,19700,19800,19900,20000,20100,20200,20300,20400,20500,20600,20700,20800,20900,21000,21100,21200,21300,21400,21500,21600,21700,21800,21900,22000,22100,22200,22300,22400,22500,22600,22700,22800,22900,23000,23100,23200,23300,23400,23500,23600,23700,23800,23900,24000,24100,24200,24300,24400,24500,24600,24700,24800,24900,25000,25100,25200,25300,25400,25500,25600,25700,25800,25900,26000,26100,26200,26300,26400,26500,26600,26700,26800,26900,27000,27100,27200,27300,27400,27500,27600,27700,27800,27900,28000,28100,28200,28300,28400,28500,28600,28700,28800,28900,29000,29100,29200,29300,29400,29500,29600,29700,29800,29900,30000,30100,30200,30300,30400,30500,30600,30700,30800,30900,31000,31100,31200,31300,31400,31500,31600,31700,31800,31900,32000,32100,32200,32300,32400,32500,32600,32700,32800,32900,33000,33100,33200,33300,33400,33500,33600,33700,33800,33900,34000,34100,34200,34300,34400,34500,34600,34700,34800,34900,35000,35100,35200,35300,35400,35500,35600,35700,35800,35900,36000,36100,36200,36300,36400,36500,36600,36700,36800,36900,37000,37100,37200,37300,37400,37500,37600,37700,37800,37900,38000,38100,38200,38300,38400,38500,38600,38700,38800,38900,39000,39100,39200,39300,39400,39500,39600,39700,39800,39900,40000,40100,40200,40300,40400,40500,40600,40700,40800,40900,41000,41100,41200,41300,41400,41500,41600,41700,41800,41900,42000,42100,42200,42300,42400,42500,42600,42700,42800,42900,43000,43100,43200,43300,43400,43500,43600,43700,43800,43900,44000,44100,44200,44300,44400,44500,44600,44700,44800,44900,45000,45100,45200,45300,45400,45500,45600,45700,45800,45900,46000,46100,46200,46300,46400,46500,46600,46700,46800,46900,47000,47100,47200,47300,47400,47500,47600,47700,47800,47900,48000,48100,48200,48300,48400,48500,48600,48700,48800,48900,49000,49100,49200,49300,49400,49500,49600,49700,49800,49900,50000,50100,50200,50300,50400,50500,50600,50700,50800,50900,51000,51100,51200,51300,51400,51500,51600,51700,51800,51900,52000,52100,52200,52300,52400,52500,52600,52700,52800,52900,53000,53100,53200,53300,53400,53500,53600,53700,53800,53900,54000,54100,54200,54300,54400,54500,54600,54700,54800,54900,55000,55100,55200,55300,55400,55500,55600,55700,55800,55900,56000,56100,56200,56300,56400,56500,56600,56700,56800,56900,57000,57100,57200,57300,57400,57500,57600,57700,57800,57900,58000,58100,58200,58300,58400,58500,58600,58700,58800,58900,59000,59100,59200,59300,59400,59500,59600,59700,59800,59900,60000,60100,60200,60300,60400,60500,60600,60700,60800,60900,61000,61100,61200,61300,61400,61500,61600,61700,61800,61900,62000,62100,62200,62300,62400,62500,62600,62700,62800,62900,63000,63100,63200,63300,63400,63500,63600,63700,63800,63900,64000,64100,64200,64300,64400,64500,64600,64700,64800,64900,65000,65100,65200,65300,65400,65500,65600,65700,65800,65900,66000,66100,66200,66300,66400,66500,66600,66700,66800,66900,67000,67100,67200,67300,67400,67500,67600,67700,67800,67900,68000,68100,68200,68300,68400,68500,68600,68700,68800,68900,69000,69100,69200,69300,69400,69500,69600,69700,69800,69900,70000,70100,70200,70300,70400,70500,70600,70700,70800,70900,71000,71100,71200,71300,71400,71500,71600,71700,71800,71900,72000,72100,72200,72300,72400,72500,72600,72700,72800,72900,73000,73100,73200,73300,73400,73500,73600,73700,73800,73900,74000,74100,74200,74300,74400,74500,74600,74700,74800,74900,75000,75100,75200,75300,75400,75500,75600,75700,75800,75900,76000,76100,76200,76300,76400,76500,76600,76700,76800,76900,77000,77100,77200,77300,77400,77500,77600,77700,77800,77900,78000,78100,78200,78300,78400,78500,78600,78700,78800,78900,79000,79100,79200,79300,79400,79500,79600,79700,79800,79900,80000,80100,80200,80300,80400,80500,80600,80700,80800,80900,81000,81100,81200,81300,81400,81500,81600,81700,81800,81900,82000,82100,82200,82300,82400,82500,82600,82700,82800,82900,83000,83100,83200,83300,83400,83500,83600,83700,83800,83900,84000,84100,84200,84300,84400,84500,84600,84700,84800,84900,85000,85100,85200,85300,85400,85500,85600,85700,85800,85900,86000,86100,86200,86300,86400,86500,86600,86700,86800,86900,87000,87100,87200,87300,87400,87500,87600,87700,87800,87900,88000,88100,88200,88300,88400,88500,88600,88700,88800,88900,89000,89100,89200,89300,89400,89500,89600,89700,89800,89900,90000,90100,90200,90300,90400,90500,90600,90700,90800,90900,91000,91100,91200,91300,91400,91500,91600,91700,91800,91900,92000,92100,92200,92300,92400,92500,92600,92700,92800,92900,93000,93100,93200,93300,93400,93500,93600,93700,93800,93900,94000,94100,94200,94300,94400,94500,94600,94700,94800,94900,95000,95100,95200,95300,95400,95500,95600,95700,95800,95900,96000,96100,96200,96300,96400,96500,96600,96700,96800,96900,97000,97100,97200,97300,97400,97500,97600,97700,97800,97900,98000,98100,98200,98300,98400,98500,98600,98700,98800,98900,99000,99100,99200,99300,99400,99500,99600,99700,99800,99900,100000],[2.84,3.3,3.05333333333333,3.23,3.176,3,3.04571428571429,3.1,3.20888888888889,3.244,3.11636363636364,3.15,3.17846153846154,3.1,3.22666666666667,3.12,3.05176470588235,3.13777777777778,3.18105263157895,3.132,3.15428571428571,3.14545454545455,3.0695652173913,3.15,3.1168,3.14615384615385,3.09481481481481,3.15857142857143,3.11310344827586,3.116,3.08516129032258,3.15125,3.16969696969697,3.17176470588235,3.12228571428571,3.09555555555556,3.13297297297297,3.14947368421053,3.15589743589744,3.136,3.12975609756098,3.16,3.13116279069767,3.15727272727273,3.13688888888889,3.15217391304348,3.16425531914894,3.12083333333333,3.13795918367347,3.1592,3.11058823529412,3.13307692307692,3.09735849056604,3.12444444444444,3.17163636363636,3.15071428571429,3.11578947368421,3.16896551724138,3.14169491525424,3.13066666666667,3.12327868852459,3.13161290322581,3.17904761904762,3.15125,3.16307692307692,3.13636363636364,3.1665671641791,3.14647058823529,3.17855072463768,3.14628571428571,3.1712676056338,3.13944444444444,3.12547945205479,3.13459459459459,3.1312,3.12105263157895,3.16051948051948,3.13025641025641,3.12860759493671,3.1485,3.13382716049383,3.10780487804878,3.09301204819277,3.13714285714286,3.14070588235294,3.1693023255814,3.11448275862069,3.15272727272727,3.13842696629213,3.13866666666667,3.13978021978022,3.14304347826087,3.15956989247312,3.17148936170213,3.12968421052632,3.1475,3.14185567010309,3.15795918367347,3.12808080808081,3.1504,3.15049504950495,3.15019607843137,3.13553398058252,3.15653846153846,3.1272380952381,3.15962264150943,3.13794392523364,3.12333333333333,3.13871559633028,3.14836363636364,3.14378378378378,3.13857142857143,3.11433628318584,3.10701754385965,3.15895652173913,3.11310344827586,3.16239316239316,3.14508474576271,3.16067226890756,3.15766666666667,3.14181818181818,3.1544262295082,3.12227642276423,3.17129032258065,3.12832,3.11936507936508,3.13228346456693,3.13,3.1537984496124,3.15661538461538,3.14320610687023,3.15090909090909,3.14736842105263,3.15373134328358,3.14637037037037,3.13147058823529,3.15503649635036,3.11420289855072,3.14820143884892,3.13542857142857,3.16964539007092,3.12647887323944,3.15188811188811,3.12972222222222,3.14151724137931,3.12438356164384,3.12625850340136,3.12459459459459,3.16402684563758,3.14,3.11761589403973,3.12394736842105,3.15137254901961,3.14727272727273,3.13754838709677,3.13128205128205,3.15006369426752,3.13594936708861,3.14817610062893,3.1265,3.12844720496894,3.14271604938272,3.15754601226994,3.15121951219512,3.16169696969697,3.13734939759036,3.15592814371258,3.11809523809524,3.14650887573965,3.14776470588235,3.15485380116959,3.1446511627907,3.14913294797688,3.14344827586207,3.14354285714286,3.15181818181818,3.15683615819209,3.12067415730337,3.16,3.16377777777778,3.14011049723757,3.15054945054945,3.1479781420765,3.15978260869565,3.14854054054054,3.13505376344086,3.13754010695187,3.15936170212766,3.13883597883598,3.14168421052632,3.14282722513089,3.14,3.14735751295337,3.15319587628866,3.14276923076923,3.13408163265306,3.14944162436548,3.1430303030303,3.13608040201005,3.144,3.13273631840796,3.1550495049505,3.13576354679803,3.16078431372549,3.12721951219512,3.13825242718447,3.13913043478261,3.11961538461538,3.12842105263158,3.15047619047619,3.14995260663507,3.14679245283019,3.14591549295775,3.14822429906542,3.14288372093023,3.135,3.16866359447005,3.13155963302752,3.16694063926941,3.15163636363636,3.14588235294118,3.12234234234234,3.13219730941704,3.16232142857143,3.12853333333333,3.14672566371681,3.14678414096916,3.14736842105263,3.13519650655022,3.14539130434783,3.13281385281385,3.12896551724138,3.14678111587983,3.13811965811966,3.1336170212766,3.14389830508475,3.15257383966245,3.1490756302521,3.13037656903766,3.137,3.1450622406639,3.12876033057851,3.15621399176955,3.13295081967213,3.15542857142857,3.13284552845528,3.12453441295547,3.14548387096774,3.12931726907631,3.14384,3.13689243027888,3.14190476190476,3.14592885375494,3.14818897637795,3.13003921568627,3.14234375,3.14879377431907,3.13085271317829,3.14810810810811,3.14815384615385,3.14804597701149,3.14610687022901,3.14220532319392,3.13893939393939,3.12709433962264,3.13954887218045,3.14591760299625,3.1465671641791,3.13591078066914,3.12444444444444,3.14228782287823,3.14308823529412,3.13611721611722,3.15124087591241,3.12189090909091,3.12565217391304,3.15494584837545,3.14158273381295,3.14838709677419,3.16814285714286,3.14220640569395,3.16056737588652,3.13512367491166,3.1330985915493,3.14315789473684,3.14923076923077,3.14857142857143,3.14402777777778,3.1359169550173,3.14855172413793,3.14213058419244,3.14287671232877,3.16423208191126,3.14748299319728,3.12108474576271,3.15,3.14141414141414,3.14053691275168,3.14969899665552,3.1316,3.1375415282392,3.13774834437086,3.14943894389439,3.14842105263158,3.14150819672131,3.15294117647059,3.15035830618893,3.14974025974026,3.15119741100324,3.15974193548387,3.13581993569132,3.14320512820513,3.13635782747604,3.14076433121019,3.14425396825397,3.15164556962025,3.12479495268139,3.15245283018868,3.12890282131661,3.138375,3.15077881619938,3.15453416149068,3.14712074303406,3.14049382716049,3.16073846153846,3.14319018404908,3.14238532110092,3.15365853658537,3.13446808510638,3.15272727272727,3.15697885196375,3.12650602409639,3.12828828828829,3.12550898203593,3.14913432835821,3.15666666666667,3.14884272997033,3.13360946745562,3.14619469026549,3.13635294117647,3.13935483870968,3.13005847953216,3.14297376093294,3.15081395348837,3.14631884057971,3.15687861271676,3.1528530259366,3.13758620689655,3.14659025787966,3.14502857142857,3.14609686609687,3.14806818181818,3.14957507082153,3.13841807909604,3.13915492957746,3.14539325842697,3.13042016806723,3.13296089385475,3.13437325905292,3.13711111111111,3.14182825484765,3.1475138121547,3.14798898071625,3.13054945054945,3.13402739726027,3.12622950819672,3.13907356948229,3.14260869565217,3.13756097560976,3.12681081081081,3.12345013477089,3.15064516129032,3.13426273458445,3.14438502673797,3.14549333333333,3.14287234042553,3.13400530503979,3.14285714285714,3.13994722955145,3.14,3.15296587926509,3.14356020942408,3.14412532637076,3.13520833333333,3.14098701298701,3.15689119170984,3.13333333333333,3.13484536082474,3.15002570694087,3.14933333333333,3.13084398976982,3.15,3.13343511450382,3.14680203045685,3.13964556962025,3.14151515151515,3.12987405541562,3.14522613065327,3.14766917293233,3.1568,3.14713216957606,3.1347263681592,3.13389578163772,3.15267326732673,3.14706172839506,3.13822660098522,3.13896805896806,3.13254901960784,3.1358435207824,3.13717073170732,3.14676399026764,3.14077669902913,3.14179176755448,3.15072463768116,3.14592771084337,3.13855769230769,3.13544364508393,3.15961722488038,3.15942720763723,3.13085714285714,3.1470783847981,3.13526066350711,3.15498817966903,3.13716981132075,3.14221176470588,3.12910798122066,3.14051522248244,3.14626168224299,3.13622377622378,3.1426976744186,3.14329466357309,3.13731481481481,3.1410623556582,3.14184331797235,3.12625287356322,3.14045871559633,3.14260869565217,3.14301369863014,3.15079726651481,3.15027272727273,3.13115646258503,3.14235294117647,3.13534988713318,3.14081081081081,3.14660674157303,3.14941704035874,3.1386129753915,3.15044642857143,3.13496659242762,3.14364444444444,3.13223946784922,3.15557522123894,3.1362472406181,3.14035242290749,3.14285714285714,3.13429824561404,3.1491466083151,3.1538864628821,3.14823529411765,3.14034782608696,3.14681127982646,3.14103896103896,3.13494600431965,3.12956896551724,3.14649462365591,3.13613733905579,3.14226980728051,3.14162393162393,3.12793176972281,3.1428085106383,3.13987261146497,3.14796610169492,3.14401691331924,3.14599156118143,3.14526315789474,3.12890756302521,3.1367714884696,3.14125523012552,3.13753653444676,3.14483333333333,3.15101871101871,3.14091286307054,3.13821946169772,3.14057851239669,3.15059793814433,3.1438683127572,3.14340862422998,3.14729508196721,3.13725971370143,3.15542857142857,3.13653767820774,3.13585365853659,3.13079107505071,3.1404048582996,3.13923232323232,3.15266129032258,3.14696177062374,3.15044176706827,3.14444889779559,3.15856,3.13620758483034,3.1400796812749,3.14592445328032,3.1415873015873,3.13116831683168,3.14450592885375,3.14414201183432,3.1407874015748,3.13571709233792,3.14047058823529,3.14489236790607,3.1528125,3.14074074074074,3.14287937743191,3.1433786407767,3.13883720930233,3.13230174081238,3.13467181467181,3.14350674373796,3.14538461538462,3.12982725527831,3.13854406130268,3.14347992351816,3.14534351145038,3.14948571428571,3.14182509505703,3.13085388994307,3.14712121212121,3.14737240075614,3.15094339622642,3.1395856873823,3.13669172932331,3.13906191369606,3.1412734082397,3.13241121495327,3.13201492537313,3.14219739292365,3.14795539033457,3.14211502782931,3.13540740740741,3.13641404805915,3.13483394833948,3.13686924493554,3.14338235294118,3.14150458715596,3.13838827838828,3.1382084095064,3.13467153284672,3.15701275045537,3.13927272727273,3.14649727767695,3.14340579710145,3.13084990958409,3.15068592057762,3.1452972972973,3.13985611510791,3.15152603231598,3.14587813620072,3.13445438282648,3.14321428571429,3.13411764705882,3.14868327402135,3.15197158081705,3.14843971631206,3.14640707964602,3.14162544169611,3.14455026455026,3.13021126760563,3.1498769771529,3.15424561403509,3.13211908931699,3.13601398601399,3.14150087260035,3.12696864111498,3.14713043478261,3.14638888888889,3.14842287694974,3.15612456747405,3.14272884283247,3.14131034482759,3.13686746987952,3.14735395189003,3.12679245283019,3.13130136986301,3.14413675213675,3.14163822525597,3.14902896081772,3.1569387755102,3.13752122241087,3.14413559322034,3.14064297800338,3.14243243243243,3.14050590219224,3.13306397306397,3.14164705882353,3.1410067114094,3.1315242881072,3.15123745819398,3.12767946577629,3.1404,3.14549084858569,3.1358803986711,3.14394693200663,3.13655629139073,3.14823140495868,3.14607260726073,3.14438220757825,3.13401315789474,3.14351395730706,3.148,3.14271685761047,3.14947712418301,3.15249592169657,3.13765472312704,3.1509593495935,3.14188311688312,3.13931928687196,3.15093851132686,3.13473344103393,3.14374193548387,3.14003220611916,3.1508038585209,3.14272873194222,3.13814102564103,3.133824,3.14875399361022,3.14443381180223,3.1403821656051,3.12502384737679,3.13568253968254,3.14237717908082,3.1470253164557,3.14483412322275,3.14145110410095,3.14431496062992,3.14081761006289,3.14166405023548,3.15009404388715,3.14109546165884,3.1450625,3.15507020280811,3.1418691588785,3.13480559875583,3.14459627329193,3.13159689922481,3.14216718266254,3.14343122102009,3.14734567901235,3.12499229583975,3.14203076923077,3.13437788018433,3.14773006134969,3.14584992343032,3.14715596330275,3.14119083969466,3.14615853658537,3.142100456621,3.13872340425532,3.13347496206373,3.14860606060606,3.1409984871407,3.14471299093656,3.13526395173454,3.1405421686747,3.14532330827068,3.14798798798799,3.15136431784108,3.14491017964072,3.14529147982063,3.14441791044776,3.1393740685544,3.14202380952381,3.1394353640416,3.14694362017804,3.13617777777778,3.14538461538462,3.13057607090103,3.14129793510324,3.14091310751105,3.14305882352941,3.14108663729809,3.13771260997067,3.14887262079063,3.13508771929825,3.13401459854015,3.16332361516035,3.13647743813683,3.14133720930233,3.15007256894049,3.13733333333333,3.14564399421129,3.14531791907514,3.13085137085137,3.14023054755043,3.15453237410072,3.13706896551724,3.13738880918221,3.13558739255014,3.13859799713877,3.14548571428571,3.14853067047076,3.1377207977208,3.15106685633001,3.13403409090909,3.14382978723404,3.13320113314448,3.14280056577086,3.14598870056497,3.15244005641749,3.14292957746479,3.14143459915612,3.1447191011236,3.15169705469846,3.13703081232493,3.14288111888112,3.13402234636871,3.14889818688982,3.13871866295265,3.1453685674548,3.148,3.14407766990291,3.14293628808864,3.14445366528354,3.13348066298343,3.136,3.14699724517906,3.12781292984869,3.14681318681319,3.1437037037037,3.14460273972603,3.14309165526676,3.14655737704918,3.14619372442019,3.1341689373297,3.14552380952381,3.14701086956522,3.13628222523745,3.14162601626016,3.13407307171854,3.13654054054054,3.1412685560054,3.1343935309973,3.14777927321669,3.13887096774194,3.14743624161074,3.14257372654155,3.13734939759036,3.13310160427808,3.13190921228304,3.13306666666667,3.15243675099867,3.13936170212766,3.14486055776892,3.14106100795756,3.15385430463576,3.13989417989418,3.14826948480845,3.13846965699208,3.1501976284585,3.12794736842105,3.14412614980289,3.14593175853018,3.13992136304063,3.13214659685864,3.14133333333333,3.13895561357702,3.13126466753585,3.14338541666667,3.14527958387516,3.13236363636364,3.14189364461738,3.14569948186529,3.13997412677878,3.14284237726098,3.13842580645161,3.14190721649485,3.13503217503218,3.15562982005141,3.13134788189987,3.14769230769231,3.14120358514725,3.14526854219949,3.13297573435504,3.14183673469388,3.13686624203822,3.1359796437659,3.14617534942821,3.14598984771574,3.14144486692015,3.15113924050633,3.14816687737042,3.13691919191919,3.14385876418663,3.13692695214106,3.15577358490566,3.14100502512563,3.13741530740276,3.1349373433584,3.14478097622028,3.13765,3.14232209737828,3.14254364089776,3.13808219178082,3.14283582089552,3.13217391304348,3.14039702233251,3.1416604708798,3.15430693069307,3.14046971569839,3.13491358024691,3.13602959309494,3.14167487684729,3.13692496924969,3.137542997543,3.13668711656442,3.1375,3.15094247246022,3.13872860635697,3.13626373626374,3.13707317073171,3.12584652862363,3.14715328467153,3.15061968408262,3.13364077669903,3.14690909090909,3.13762711864407,3.14021765417171,3.13507246376812,3.14581423401689,3.14053012048193,3.13540312876053,3.13841346153846,3.13728691476591,3.1421582733813,3.14524550898204,3.15172248803828,3.12874551971326,3.1327446300716,3.13253873659118,3.13480952380952,3.14720570749108,3.1378622327791,3.14671411625148,3.13862559241706,3.14262721893491,3.13654846335697,3.14040141676505,3.13396226415094,3.13469964664311,3.12809411764706,3.15243243243243,3.14023474178404,3.14499413833529,3.15231850117096,3.14750877192982,3.14733644859813,3.1473512252042,3.13771561771562,3.14998835855646,3.1286511627907,3.14076655052265,3.14287703016241,3.13589803012746,3.13907407407407,3.14917919075145,3.14369515011547,3.15100346020761,3.14847926267281,3.14881472957422,3.13425287356322,3.13731343283582,3.14477064220183,3.14845360824742,3.14645308924485,3.14395428571429,3.14237442922374,3.14171037628278,3.13649202733485,3.13560864618885,3.14177272727273,3.14583427922815,3.14834467120181,3.13748584371461,3.14276018099548,3.14946892655367,3.13661399548533,3.1379932356257,3.1304954954955,3.14029246344207,3.14301123595506,3.12875420875421,3.13452914798206,3.14400895856663,3.14420581655481,3.13094972067039,3.14651785714286,3.15130434782609,3.14365256124722,3.13410456062291,3.14671111111111,3.15231964483907,3.14514412416851,3.14516057585825,3.15061946902655,3.14311602209945,3.14194260485651,3.14306504961411,3.1415859030837,3.14433443344334,3.14905494505494,3.13462129527991,3.14342105263158,3.14405257393209,3.13588621444201,3.13193442622951,3.1346288209607,3.14233369683751,3.13947712418301,3.14415669205658,3.1385652173913,3.13502714440825,3.13882863340564,3.14738894907909,3.13632034632035,3.13781621621622,3.15356371490281,3.14101402373247,3.13650862068966,3.13692142088267,3.12997849462366,3.14633727175081,3.13463519313305,3.14199356913183,3.13250535331906,3.14006417112299,3.14166666666667,3.14224119530416,3.13910447761194,3.15263045793397,3.144,3.1401912858661,3.13626326963907,3.13815482502651,3.13834745762712,3.14251851851852,3.14477801268499,3.14394931362196,3.14333333333333,3.14166491043203,3.14349473684211,3.13993690851735,3.13357142857143,3.14207764952781,3.13819706498952,3.14475392670157,3.15016736401674,3.14700104493208,3.13791231732777,3.14110531803962,3.15354166666667,3.13823100936524,3.14577962577963,3.14230529595016,3.14452282157676,3.14184455958549,3.14190476190476,3.14349534643226,3.14607438016529,3.15046439628483,3.15105154639175,3.14236869207003,3.13530864197531,3.1456937307297,3.13420944558522,3.13669743589744,3.14036885245902,3.14640736949846,3.13840490797546,3.14345250255363,3.1449387755102,3.14544342507645,3.14199592668024,3.14608341810783,3.14821138211382,3.14615228426396,3.14336713995943,3.14066869300912,3.14064777327935,3.14212335692619,3.14117171717172,3.15075681130172,3.13508064516129,3.14227593152064,3.14181086519115,3.14211055276382,3.14763052208835,3.14230692076229,3.13967935871743,3.13957957957958,3.13656]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>반복횟수<\/th>\n      <th>원주율<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatCurrency(this, row, data, 2, '', 5, 3, ',', '.', true);\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><!--/html_preserve-->

모의실험횟수가 증가함에 따라 위키백과사전 [원주율](https://ko.wikipedia.org/wiki/%EC%9B%90%EC%A3%BC%EC%9C%A8) 값에 수렴되는지를 
시각적으로 확인한다. 

> 원주율: "3.1415926535897932384626433832795028841971"


~~~{.r}
## 3.2. 시각화 -------------------------------

ggplot(pi_df, aes(x=반복횟수, y=원주율)) +
  geom_line() +
  theme_ipsum(base_family="NanumGothic") +
  labs(x="모의실험횟수", y="원주율값") +
  scale_x_continuous(labels = scales::comma) +
  geom_hline(yintercept = 3.1415926535897932384626433832795028841971, color="red")
~~~

<img src="fig/monte-carlo-sim-plot-1.png" style="display: block; margin: auto;" />

## 3. 몬테카를로 모의실험 시각화 {#r-monte-carlo-sim-viz}

원주율을 계산하는 몬테카를로 모의실험 결과를 시각화해보자.
1,000회 난수를 추출하여 이를 앞서 계산한 로직에 맞춰 결과값이 원내부에 위치하면 검은색 점으로,
원외부에 위치하면 붉은색 점으로 표현하여 보자.



~~~{.r}
# 4. 모의실험 1000회 시각화 ------------------------------
r <- 1
par(pty="s")
emptyplot(c(0, 0),frame.plot=r)
plotcircle(r=r, mid=c(0,0), lwd=1, lcol="blue")
lines(x=c(0,1),y=c(0,0), lty=1, col="red")
lines(x=c(-1,1),y=c(0,0), lty=2)
lines(y=c(-1,1),x=c(0,0), lty=2)
axis(1)
axis(2)
text(x=0.5,y=0.2, labels=expression("r=1"), col="red")

draw_point <- function(iter = 10) {
  
  x_pos <- runif(iter, min=-1, max=1)
  y_pos <- runif(iter, min=-1, max=1)
  
  for(i in seq_along(x_pos)) {
    if( x_pos[i]^2+y_pos[i]^2 <=1 ) {
      points(x_pos[i], y_pos[i], col="black")
    } else {
      points(x_pos[i], y_pos[i], col="red")
    }
  } 
}

draw_point(1000)
~~~

<img src="fig/monte-carlo-sim-plot-dots-1.png" style="display: block; margin: auto;" />

